(function(global){var TextLine=function(font,text){this.$ctx=document.createElement("canvas").getContext("2d");this.$ctx.font=font;this.text=text};TextLine.prototype={constructor:TextLine,getTextWidth:function(){return this.$ctx.measureText(this.text).width},getTextHeight:function(){const width=this.$ctx.measureText("M").width;return width*7/6}};var Meter=function(el,options){options=options||{};var rect=el.getBoundingClientRect();this._ctx=el.getContext("2d");el.width=rect.width;el.height=rect.height;this.constructor.checkConf(options);this._conf=this.constructor.extend(true,this.constructor.CONF,options);if(this._conf.maxTemp<=this._conf.minTemp){throw new Error("[Meter] options property?maxTemp must gt minTemp")}if((this._conf.maxTemp-this._conf.minTemp)%this._conf.scaleOffset!==0){throw new Error("[Meter] options property?scaleOffset must keep [(maxTemp - minTemp) % scaleOffset === 0]")}this._conf.tempCap=this._conf.tempCap==="round"?"round":"butt";this._conf.ballRadius=Math.max(this._conf.ballRadius,this._conf.tempWidth/2);this._conf.scalePlacement=this.constructor.oneOf(["both","left","right"],this._conf.scalePlacement)?this._conf.scalePlacement:"left";this._conf.tempVal=Math.max(this._conf.minTemp,Math.min(this._conf.tempVal,this._conf.maxTemp));this._conf.extendOffset=this._conf.ballRadius-Math.sqrt(this._conf.ballRadius*this._conf.ballRadius-this._conf.tempWidth*this._conf.tempWidth/4);this._conf._fontTitleHeight=this._conf.showLabel?new TextLine(this._conf.titleFont+" "+this._conf.fontFamily,this._conf.tempTitle).getTextHeight()+this._conf.titleOffsetBottom:0;this._conf._fontValHeight=new TextLine(this._conf.valFont+" "+this._conf.fontFamily,this._conf.tempTitle).getTextHeight()+this._conf.valOffsetTop;var _this=this;this._count=new Count(this._conf.minTemp,this._conf.tempVal,this._conf.duration,function(val){_this._conf.tempVal=val.toFixed(2);_this._init()});this._count.start()};Meter.oneOf=function(list,attr){return new RegExp("\\b"+attr+"\\b").test(list.join(","))
};Meter.checkConf=function(options){var CONF=this.CONF;Object.keys(CONF).forEach(function(item,key){var type=typeof CONF[item];if(options[item]&&typeof options[item]!==type){throw new TypeError("[Meter] options property?"+item+" is not a "+type)}})};Meter.toNumber=function(n){var val=parseFloat(n);return isNaN(val)?n:val};Meter.extend=function(){var j,resource,i=0;var target=arguments[0];var argList=Array.prototype.slice.call(arguments,1);var argLen=argList.length;target=typeof target==="boolean"?{}:target;while(i<argLen){resource=argList[i++];for(j in resource){if(resource.hasOwnProperty(j)){target[j]=resource[j]}}}return target};Meter.CONF={tempTitle:"???",titleFont:"20px",titleOffsetBottom:20,titleColor:"#000000",margin:20,offset:5,ballRadius:20,valFont:"20px",valOffsetTop:10,tempVal:26,tempWidth:20,maxTemp:100,minTemp:0,tempCap:"butt",tempBgColor:"#cccccc",tempActiveBgColor:"#888888",scaleColor:"#888888",scaleOffset:10,scaleFont:"14px",fontFamily:"Helvetica ",scalePlacement:"left",cursorWidth:30,cursorHeight:7,cursorBgColor:"#F08080",showLabel:true,showCursor:true,showBall:true};Meter.prototype={constructor:Meter,v:"0.0.1",_init:function(){this._ctx.clearRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height);this._ctx.save();this._ctx.beginPath();this._ctx.translate(this._ctx.canvas.width/2,this._ctx.canvas.height-this._conf.margin);this._render();this._ctx.restore()},_render:function(){var i=0;var signList=this._conf.scalePlacement==="both"?[-1,1]:this._conf.scalePlacement==="left"?[-1]:[1];var ii=signList.length;if(this._conf.showLabel){this._drawTitleText()}this._drawValText();this._drawBaseShell(false);this._drawBaseShell(true);for(;i<ii;i++){this._drawBaseScale(signList[i])}if(!this._conf.showCursor){return}for(i=0;i<ii;i++){this._drawCursor(signList[i])}},update:function(newVal){newVal=Math.max(this._conf.minTemp,Math.min(newVal,this._conf.maxTemp));this._count.update(newVal)},_drawTitleText:function(){this._ctx.save();this._ctx.beginPath();this._ctx.translate(0,this._conf.margin*2-this._ctx.canvas.height);
this._ctx.font=this._conf.titleFont+" "+this._conf.fontFamily;this._ctx.fillStyle=this._conf.titleColor;this._ctx.textAlign="center";this._ctx.textBaseline="middle";this._ctx.fillText(this._conf.tempTitle,0,0);this._ctx.restore()},_drawValText:function(){this._ctx.save();this._ctx.beginPath();this._ctx.font="24px "+this._conf.fontFamily;this._ctx.textAlign="center";this._ctx.textBaseline="middle";this._ctx.fillText(this._conf.tempVal,0,0);this._ctx.restore()},_drawBaseShell:function(bool){var radius=this._conf.showBall?this._conf.ballRadius:0;var height=(this._conf.margin+radius)*2-this._ctx.canvas.height+this._conf._fontTitleHeight+this._conf._fontValHeight;var tempHeight=!bool?height:(this._conf.tempVal-this._conf.minTemp)*height/(this._conf.maxTemp-this._conf.minTemp);this._ctx.save();this._ctx.translate(0,-radius*2-this._conf._fontValHeight);this._ctx.fillStyle=!bool?this._conf.tempBgColor:this._conf.tempActiveBgColor;this._ctx.beginPath();if(this._conf.tempCap==="butt"){this._ctx.fillRect(-this._conf.tempWidth/2,0,this._conf.tempWidth,tempHeight)}else{this._ctx.moveTo(-this._conf.tempWidth/2,0);this._ctx.arcTo(-this._conf.tempWidth/2,tempHeight,this._conf.tempWidth/2,tempHeight,this._conf.tempWidth/2);this._ctx.arcTo(this._conf.tempWidth/2,tempHeight,this._conf.tempWidth/2,-radius,this._conf.tempWidth/2);this._ctx.lineTo(this._conf.tempWidth/2,0);this._ctx.fill()}if(this._conf.showBall){this._ctx.beginPath();this._ctx.fillRect(-this._conf.tempWidth/2,0,this._conf.tempWidth,this._conf.extendOffset);this._ctx.beginPath();this._ctx.arc(0,radius,radius,0,2*Math.PI,false);this._ctx.fill()}this._ctx.restore()},_drawBaseScale:function(n){var total=this._conf.maxTemp-this._conf.minTemp;var radius=this._conf.showBall?this._conf.ballRadius:0;var tempHeight=(this._conf.margin+radius)*2-this._ctx.canvas.height+this._conf._fontTitleHeight+this._conf._fontValHeight+1;this._ctx.save();this._ctx.translate((this._conf.tempWidth/2+this._conf.offset)*n,-radius*2-this._conf._fontValHeight);
this._ctx.beginPath();this._ctx.strokeStyle=this._conf.scaleColor;this._ctx.lineWidth=1;this._ctx.moveTo(n*0.5,0);this._ctx.lineTo(n*0.5,tempHeight);this._ctx.stroke();for(var i=0;i<=total;i++){this._ctx.save();this._ctx.beginPath();this._ctx.translate(0,i*tempHeight/total);this._ctx.strokeStyle=this._conf.scaleColor;this._ctx.moveTo(n*0.5,-0.5);if(i%this._conf.scaleOffset===0){this._ctx.lineTo(n*10.5,-0.5);this._ctx.font=this._conf.scaleFont+" "+this._conf.fontFamily;this._ctx.fillStyle=this._conf.scaleColor;this._ctx.textAlign=n===-1?"right":"left";this._ctx.textBaseline="middle";this._ctx.fillText(i+this._conf.minTemp,n*15.5,-0.5)}else{this._ctx.lineTo(n*5.5,-0.5)}this._ctx.stroke();this._ctx.restore()}this._ctx.restore()},_drawCursor:function(n){var radius=this._conf.showBall?this._conf.ballRadius:0;var tempHeight=(this._conf.margin+radius)*2-this._ctx.canvas.height+this._conf._fontTitleHeight+this._conf._fontValHeight;var val=(this._conf.tempVal-this._conf.minTemp)*tempHeight/(this._conf.maxTemp-this._conf.minTemp);this._ctx.beginPath();this._ctx.save();this._ctx.translate(-(this._conf.tempWidth/2+this._conf.offset)*n,-radius*2+val-this._conf._fontValHeight);this._ctx.fillStyle=this._conf.cursorBgColor;this._ctx.moveTo(n*this._conf.offset/2,0);this._ctx.lineTo(-n*this._conf.cursorWidth/3,-this._conf.cursorHeight/2);this._ctx.lineTo(-n*this._conf.cursorWidth,-this._conf.cursorHeight/2);this._ctx.lineTo(-n*this._conf.cursorWidth,this._conf.cursorHeight/2);this._ctx.lineTo(-n*this._conf.cursorWidth/3,this._conf.cursorHeight/2);this._ctx.fill();this._ctx.restore()}};global.Meter=Meter}(window));
(function(global){var Count=function(startVal,endVal,duration,callback){var ensureNumber=this.constructor.ensureNumber;startVal=Number(startVal);endVal=Number(endVal);duration=Number(duration);callback=callback||function(){};if(!ensureNumber(startVal)||!ensureNumber(endVal)||!ensureNumber(duration)){console.error("[Count] startVal (${startVal}) or endVal (${endVal}) or duration (${duration}) is not a number");return}this.timer=null;this.isStart=false;this.isPause=false;this.startVal=startVal;this.endVal=endVal;this.originDuration=this.duration=duration||3000;this.callback=callback;this.countDown=this.startVal>this.endVal};Count.ensureNumber=function(val){return !isNaN(val)&&typeof val==="number"};Count.easeOutExpo=function(t,b,c,d){return -c*((t=t/d-1)*t*t*t-1)+b};Count.prototype={constructor:Count,v:"0.0.1",count:function(timestamp){var progress,val;if(!this.startTime){this.startTime=timestamp}progress=timestamp-this.startTime;this.remaining=Math.max(this.duration-progress,0);val=this.countDown?this.startVal-this.constructor.easeOutExpo(progress,0,this.startVal-this.endVal,this.duration):this.constructor.easeOutExpo(progress,this.startVal,this.endVal-this.startVal,this.duration);this.frameVal=this.countDown?Math.max(val,this.endVal):Math.min(val,this.endVal);if(progress<this.duration){this.timer=window.requestAnimationFrame(this.count.bind(this))}else{this.isStart=false}this.frameVal=this.isStart?this.frameVal:this.endVal;this.callback(this.frameVal,this.originDuration-this.remaining,!this.isStart)},start:function(){if(this.isStart){return}if(this.endVal===this.frameVal){return}this.isStart=true;this.timer=window.requestAnimationFrame(this.count.bind(this))},update:function(newEndVal){newEndVal=Number(newEndVal);if(!this.constructor.ensureNumber(newEndVal)){console.error("[CountUp] update() - new endVal is not a number: "+newEndVal);return}if(this.timer){window.cancelAnimationFrame(this.timer);this.timer=null;this.isStart=false}if(newEndVal===this.frameVal){return}delete this.startTime;
this.endVal=newEndVal;this.startVal=this.frameVal||this.startVal;this.duration=this.remaining||this.duration;this.countDown=this.startVal>this.endVal;this.start()},pause:function(){if(!this.isStart||this.isPause){return}this.isPause=true;if(this.timer){window.cancelAnimationFrame(this.timer);this.timer=null}delete this.startTime},resume:function(){if(!this.isStart||!this.isPause){return}this.isPause=false;this.startVal=this.frameVal;this.duration=this.remaining;this.timer=window.requestAnimationFrame(this.count.bind(this))},reset:function(){this.timer=null;this.isStart=false;this.isPause=false;delete this.frameVal;delete this.remaining;delete this.startTime;this.duration=this.originDuration;this.countDown=this.startVal>this.endVal}};global.Count=Count}(window));
